include:
  - local: '/ci/build_containers_base.yml'

Build Person Container:
  variables:
    SERVICE_NAME: "person-service"
    DOCKERFILE_PATH: "./person-service"
    SERVICE_NAME_STACK: "stack_person"
  extends: .build_container_base
  dependencies:
    - Build Person Service
  only:
    changes:
      - "person-service/**/*"

Build Message Container:
  variables:
    SERVICE_NAME: "message-service"
    DOCKERFILE_PATH: "./message-service"
    SERVICE_NAME_STACK: "stack_message"
  extends: .build_container_base
  dependencies:
    - Build Message Service
  only:
    changes:
      - "message-service/**/*"

Build Chat Container:
  variables:
    SERVICE_NAME: "chat-service"
    DOCKERFILE_PATH: "./chat-service"
    SERVICE_NAME_STACK: "stack_chat"
  extends: .build_container_base
  dependencies:
    - Build Chat Service
  only:
    changes:
      - "chat-service/**/*"

Build Config Container:
  variables:
    SERVICE_NAME: "config-server"
    DOCKERFILE_PATH: "./infrastructure/config-server"
    SERVICE_NAME_STACK: "stack_config"
  extends: .build_container_base
  dependencies:
    - Build Config Server
  only:
    changes:
      - "infrastructure/config-server/**/*"

Build Eureka Container:
  variables:
    SERVICE_NAME: "eureka-server"
    DOCKERFILE_PATH: "./infrastructure/eureka-server"
    SERVICE_NAME_STACK: "stack_eureka"
  extends: .build_container_base
  dependencies:
    - Build Eureka
  only:
    changes:
      - "infrastructure/eureka-server/**/*"

Build Gateway Container:
  variables:
    SERVICE_NAME: "gateway-server"
    DOCKERFILE_PATH: "./infrastructure/gateway-server"
    SERVICE_NAME_STACK: "stack_gateway"
  extends: .build_container_base
  dependencies:
    - Build Gateway
  only:
    changes:
      - "infrastructure/gateway-server/**/*"
